# Description
This program uses Yahoo Finance API to analyze a random set of stock tickers from NASDAQ stock exchange, based on their beta, market cap, ESG score, earnings surprise, and sector classification. The program will determine whether to buy, sell, or hold each stock based on the analysis.

## Requirements
- Python 3.6 or later
- yahooquery package
- ticker_symbols.txt file containing a list of NASDAQ stock tickers

## Methodology
The program calculates the accuracy of five methods for each ticker: beta, market cap, ESG score, earnings surprise, and sector classification. The accuracy for each method is calculated as the percentage of times the method predicted the correct action for a given stock (buy, sell, or hold). Each factor method is then weighted by its accuracy. The program uses the following methodology to determine whether to buy, sell, or hold a stock for each fastor method:

### Beta
-  If beta > 1, sell the stock as it is considered more volatile than the market.
- If beta < 1, buy the stock as it is considered less volatile than the market.
-  If beta = 1, hold the stock as it has the same volatility as the market.
### Market cap
- If market cap < $5 billion, buy the stock.
- If market cap > $15 billion, sell the stock.
- If $5 billion < market cap < $15 billion, hold the stock.

### ESG score
- If ESG score >= 70, buy the stock.
- If ESG score < 50, sell the stock.
- If neither buying nor selling conditions are met, hold the stock.

### Earnings surprise
- If earnings surprise > 0, buy the stock.
- If earnings surprise < 0, sell the stock.
- If earnings surprise = 0, hold the stock.

### Sector classification
- If the stock is in the Technology sector, buy the stock.
- If the stock is in the Utilities or Consumer Staples sectors, sell the stock.
- If neither buying nor selling conditions are met, hold the stock.


### Final Decision Method
The determine_stock_decision method is a function that takes several arguments including a stock symbol, beta percentage, market cap percentage, ESG percentage, earnings surprise percentage, and sector percentage. 

The determine_stock_decision method then calculates the weighted average of factor predictions based on the provided percentage weights for each one, generated by the buildWeightTable() function. It uses a simple algorithm to assign a numerical value of 1, -1, or 0 to each factor prediction multiplied by its weight, based on the recommended action. Then, it sums up these values and divides by the total number of factors evaluated to obtain the weighted average.

Finally, the function determines whether to buy or sell the stock based on the given calculated weighted average. It returns the string "buy" if the weighted average is positive, indicating a recommendation to buy the stock, and "sell" if the weighted average is negative, indicating a recommendation to sell the stock. The absolute value of the weighted average is between 0 and 1. 

## Program Example 1
The following is an example of the program evaluating MSFT for a growth portfolio using data gathered from 20 symbols.

```
-------------------------------
Evaluating MSFT for a Growth portfolio. 

Running simulation to gather accuracy of factors...
Simulation size: 20 symbols
------------------------------
Total tested symbols:  17  of  20
Data was unavailable for symbols: 
[ WRB^E, CTA^A, OAK^A ]

Beta accuracy: 52.94%
Market cap accuracy: 47.06%
ESG accuracy: 17.65%
Earnings surprise accuracy: 52.94%
Sector accuracy: 5.88%
------------------------------
Gathering average simulation certainty for 50 symbols...
Weighted Certainty:  0.18032786885245422


MSFT  factor evaluation: 
Beta:  b
MC:  s
ESG:  s
ESP:  b
Sector:  b 

Factor Weights: 
Beta: 0.13235294117647056
Market Cap: -0.11764705882352944
ESG: -0.17647058823529413
Earnings Surprise: 0.13235294117647056
Sector: 0.01470588235294118

Certainties: 
Decision Certainty: 0.29%
Average Certainty: 0.36%
Difference: -18.03%

Final Decision:  hold

------ Explanation ------
According to this program's methodology, the best option for a growth portfolio would be to hold MSFT.
Here are reasons that contribute to that decision:

- Since this evaluation is for an growth portfolio, the simulation utilizes only 1 year of data to shorten the intended span of investment, increasing risk.
  and recommends to hold because the decision certainty was not at least 20% more certain than the average certainty found in simulation.
  These values are altered to maximize growth.
- Despite the decision to hold, the recommendations of Market Cap and ESG indicated the best option was to sell
  and  Beta, Earnings Surprise, and Sector  indicated the best option was to buy. These recommendations were determined too risky for the portfolio.

```

## Program Example 2
The following is an example of the program evaluating AAPL for an income portfolio using data gathered from 20 symbols.

``` 
-------------------------------
Evaluating AAPL for an Income portfolio. 

Running simulation to gather accuracy of factors...
Simulation size: 20 symbols
------------------------------
Total tested symbols:  19  of  20
Data was unavailable for symbols: 
[ WRB^F ]

Beta accuracy: 63.16%
Market cap accuracy: 36.84%
ESG accuracy: 0.00%
Earnings surprise accuracy: 57.89%
Sector accuracy: 15.79%
------------------------------
Gathering average simulation certainty for 50 symbols...
Weighted Certainty:  0.23076923076923084


AAPL  factor evaluation: 
Beta:  s
MC:  s
ESG:  s
ESP:  b
Sector:  b 

Factor Weights: 
Beta: -0.15789473684210525
Market Cap: -0.09210526315789475
ESG: -0.0
Earnings Surprise: 0.14473684210526316
Sector: 0.039473684210526314

Certainties: 
Decision Certainty: 1.32%
Average Certainty: 1.71%
Difference: -23.08%

Final Decision:  hold

------ Explanation ------
According to this program's methodology, the best option for a income portfolio would be to hold AAPL.
Here are reasons that contribute to that decision:

- Since this evaluation is for an income portfolio, the simulation utilizes the average of 10 years of data
  and recommends to hold because the decision certainty was not at least 50% more certain than the average certainty found in simulation.
  These values are altered to minimize risk.
- Despite the decision to hold, the recommendations of Beta and Market Cap indicated the best option was to sell
  and  Earnings Surprise and Sector  indicated the best option was to buy. These recommendations were all determined too risky for the portfolio.
```

## Program Example 3
The following is an example of the program evaluating AAPL for an ESG portfolio using data gathered from 100 symbols.


```
-------------------------------
Evaluating AAPL for an ESG portfolio. 

Running simulation to gather accuracy of factors...
Simulation size: 100 symbols
------------------------------
Total tested symbols:  80  of  100
Data was unavailable for symbols: 
[ GNL^A, CNO^A, DBRG^I, SCE^G, VOYA^B, AAM^B, NEE^R, NGL^C, GS^C, STT^G, DLR^J, PSEC^A, KIM^L, KIM^M, UBP^H, WRB^E, RITM^C, WRB^F, SRC^A, WCC^A ]

Beta accuracy: 62.50%
Market cap accuracy: 35.00%
ESG accuracy: 1.25%
Earnings surprise accuracy: 53.75%
Sector accuracy: 10.00%
------------------------------
Gathering average simulation certainty for 50 symbols...
Weighted Certainty:  0.598173515981735


AAPL  factor evaluation: 
Beta:  s
MC:  s
ESG:  s
ESP:  b
Sector:  b 

Factor Weights: 
Beta: -0.15625
Market Cap: -0.08750000000000002
ESG: -0.0031249999999999993
Earnings Surprise: 0.13437500000000002
Sector: 0.024999999999999994

Certainties: 
Decision Certainty: 1.75%
Average Certainty: 1.09%
Difference: 59.82%

Final Decision:  sell

------ Explanation ------
According to this program's methodology, the best option for a esg portfolio would be to sell AAPL.
Here are reasons that contribute to that decision:

- Since this evaluation is for an ESG portfolio, the values of all other factors are decreased by 75% to lean in favor of ESG decisions
  The simulation utilizes 10 years of data, and requires a decision certainty of 50% to reduce risk.
- The recommendation from Beta, Market Cap, and ESG suggests that the best option is to sell
  Although the recommendation from Earnings Surprise and Sector suggests that the best option is to buy,
  the indication of Beta, Market Cap, and ESG  weighs in favor of the decision to sell.

```
